"""Configurations of RBE builds used with remote config."""

load("//tools/toolchains/remote_config:rbe_config.bzl", "sigbuild_tf_configs", "tensorflow_local_config", "tensorflow_rbe_config", "tensorflow_rbe_win_config")

def initialize_rbe_configs():
    tensorflow_local_config(
        name = "local_execution",
    )

    tensorflow_rbe_config(
        name = "ubuntu20.04-clang_manylinux2014-cuda12.3-cudnn8.9",
        cuda_version = "12.3.2",
        cudnn_version = "8.9.7.29",
        os = "ubuntu20.04-manylinux2014-multipython",
    )

    tensorflow_rbe_config(
        name = "ubuntu20.04-clang_manylinux2014-cuda12.3-cudnn9.1",
        cuda_version = "12.3.2",
        cudnn_version = "9.1.1",
        os = "ubuntu20.04-manylinux2014-multipython",
    )

    tensorflow_rbe_config(
        name = "ubuntu20.04-gcc9_manylinux2014-cuda12.3-cudnn8.9",
        cuda_version = "12.3.2",
        cudnn_version = "8.9.7.29",
        os = "ubuntu20.04-manylinux2014-multipython",
    )

    tensorflow_rbe_config(
        name = "ubuntu22.04-clang_manylinux2014-cuda12.3-cudnn8.9",
        cuda_version = "12.3.2",
        cudnn_version = "8.9.7.29",
        os = "ubuntu22.04-manylinux2014-multipython",
    )

    tensorflow_rbe_config(
        name = "ubuntu22.04-gcc9_manylinux2014-cuda12.3-cudnn8.9",
        cuda_version = "12.3.2",
        cudnn_version = "8.9.7.29",
        os = "ubuntu22.04-manylinux2014-multipython",
    )

    tensorflow_rbe_win_config(
        name = "windows_py37",
        python_bin_path = "C:/Python37/python.exe",
    )

    # TF-Version-Specific SIG Build RBE Configs. The crosstool generated from these
    # configs are python-version-independent because they only care about the
    # tooling paths; the container mapping is useful only so that TF RBE users
    # may specify a specific Python version container. Yes, we could use the tag name instead,
    # but for vague security reasons we're obligated to use the pinned hash and update manually.
    # The name_container_map is helpfully auto-generated by a GitHub Action. You have to run it
    # manually. See go/tf-devinfra/docker#how-do-i-update-rbe-images

    sigbuild_tf_configs(
        name_container_map = {
            "sigbuild-r2.16": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-python3.9": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-python3.10": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-python3.11": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-python3.12": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
        },
    )

    sigbuild_tf_configs(
        name_container_map = {
            "sigbuild-r2.16-clang": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-clang-python3.9": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-clang-python3.10": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-clang-python3.11": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.16-clang-python3.12": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
        },
    )

    sigbuild_tf_configs(
        name_container_map = {
            "sigbuild-r2.17": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-python3.9": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-python3.10": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-python3.11": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-python3.12": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
        },
    )

    sigbuild_tf_configs(
        name_container_map = {
            "sigbuild-r2.17-clang": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-python3.9": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-python3.10": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-python3.11": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-python3.12": "docker://us-central1-docker.pkg.dev/tensorflow-sigs/tensorflow/ml-build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
        },
    )

    sigbuild_tf_configs(
        name_container_map = {
            "sigbuild-r2.17-clang-cudnn9": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-cudnn9-python3.9": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-cudnn9-python3.10": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-cudnn9-python3.11": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
            "sigbuild-r2.17-clang-cudnn9-python3.12": "docker://gcr.io/tensorflow-sigs/build@sha256:0423ba5dea2bd7f060f560eb77c4f5078678064bd67a318a99a36f920b44f224",
        },
    )
